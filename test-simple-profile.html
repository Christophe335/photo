<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple - Modification Prénom</title>
</head>
<body>
    <h1>Test Simple - Modification Prénom</h1>
    
    <form id="test-form" method="POST" action="clients/ajax/update-profile.php">
        <div>
            <label>Prénom:</label>
            <input type="text" name="prenom" id="prenom" value="TestPrenom" required>
        </div>
        <div>
            <label>Nom:</label>
            <input type="text" name="nom" value="TestNom" required>
        </div>
        <div>
            <label>Email:</label>
            <input type="email" name="email" value="test@test.com" required>
        </div>
        <div>
            <label>Adresse:</label>
            <input type="text" name="adresse" value="123 Rue Test" required>
        </div>
        <div>
            <label>Code Postal:</label>
            <input type="text" name="code_postal" value="75001" required>
        </div>
        <div>
            <label>Ville:</label>
            <input type="text" name="ville" value="Paris" required>
        </div>
        <input type="hidden" name="pays" value="France">
        <input type="hidden" name="newsletter" value="0">
        
        <br><br>
        <button type="submit" id="submit-btn">Enregistrer (Form Submit)</button>
        <button type="button" id="ajax-btn">Enregistrer (AJAX)</button>
    </form>
    
    <div id="result"></div>
    
    <script>
        // Test avec AJAX (comme sur le site)
        document.getElementById('ajax-btn').addEventListener('click', function() {
            const form = document.getElementById('test-form');
            const formData = new FormData(form);
            
            // Changer le prénom pour voir si ça marche
            const timestamp = Date.now();
            formData.set('prenom', 'AJAX_' + timestamp);
            
            console.log('Données envoyées:', Object.fromEntries(formData));
            
            fetch('clients/ajax/update-profile.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log('Réponse:', data);
                document.getElementById('result').innerHTML = 
                    '<h3>Résultat AJAX:</h3><pre>' + JSON.stringify(data, null, 2) + '</pre>';
            })
            .catch(error => {
                console.error('Erreur:', error);
                document.getElementById('result').innerHTML = 
                    '<h3>Erreur AJAX:</h3><pre>' + error + '</pre>';
            });
        });
        
        // Préremplir le prénom avec un timestamp pour le test
        document.getElementById('prenom').value = 'Test_' + Date.now();
    </script>
    
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        div { margin-bottom: 10px; }
        label { display: inline-block; width: 100px; }
        input { padding: 5px; margin-left: 10px; }
        button { margin: 10px; padding: 10px; }
        #result { margin-top: 20px; background: #f5f5f5; padding: 10px; border-radius: 5px; }
    </style>
</body>
</html>